
if(!window.netflix){window.netflix={}}window.netflix.namespace=function(D){var B=window.netflix;var F=null;var E=D.split(".");if(E[0]==="netflix"){E.shift()}var A=E.length;for(var C=0;C<A;++C){F=E[C].toString();if(!!F){B=B[F]=B[F]||{}}}return B};
if(!netflix.search){netflix.search={}}netflix.search.SearchResultSet=function(D,B,A,C){this.query=D;this.movies=B;this.genres=A;this.people=C;this.size=0;if(this.movies!=undefined){this.size=this.movies.length}if(this.genres!=undefined){this.size+=this.genres.length}if(this.people!=undefined){this.size+=this.people.length}dbg("SRS size "+this.size,"green")};netflix.search.SearchResultSet.prototype={getQuery:function(){return this.query},getMovies:function(){return this.movies},getGenres:function(){return this.genres},getPeople:function(){return this.people},getSize:function(){return this.size},filter:function(A){return new netflix.search.SearchResultSet(this.getQuery(),this.filterCollection(A,this.getMovies()),this.filterCollection(A,this.getGenres()),this.filterCollection(A,this.getPeople()))},filterCollection:function(G,E){var F=[];var A=E?E.length:0;for(var C=0;C<A;C++){var D=E[C];var B=(D.name+netflix.search.SearchResultCache.PIECE_DELIM+D.id).toLowerCase();if(B.indexOf(G)!=-1){F.push(D)}}return F}};netflix.search.SearchResultCache=(function(B,A){return{MIN_MATCHES:6,PIECE_DELIM:"|||",lastQuery:null,DEFAULT_AUTOCOMPLETE_URL:"/JSON/AutoCompleteSearch",cacheDirections:{forward:true,backward:false},serverRequest:{WAIT_DURATION:150,timeoutId:null,query:null,register:function(D,E){var C=netflix.search.SearchResultCache.serverRequest;C.cancel();C.query=D;C.timeoutId=E},cancel:function(){var C=netflix.search.SearchResultCache.serverRequest;clearTimeout(C.timeoutId);C.query=null;C.timeoutId=null}},cache:{},query:function(G,D,C){var F=this.serverRequest;F.cancel();G=G.toLowerCase();this.lastQuery=G;var H=this.generateCacheName(C);if(this.isInCache(H,G)){D(this.getFromCache(H,G));return }var E=this.getCachedResultsForSimilarQuery(H,G);if(E&&!/^[0-9]+$/.test(G)){D(E)}else{D(null);this.serverRequest.register(G,setTimeout(function(){netflix.search.SearchResultCache.getResultsFromServer(G,D,C)},netflix.search.SearchResultCache.serverRequest.WAIT_DURATION))}},getResultsFromServer:function(J,L,H){var C=netflix.search.SearchResultCache,D=C.serverRequest,F=H.queryOptions;D.cancel();var K=H&&H.cloudUrl&&"jsonp"||"json",I=this.generateCacheName(H);var G=function(M){var N=new netflix.search.SearchResultSet(J,M.autocomplete&&M.autocomplete.title||M.movies,M.genres,M.people);C.addToCache(I,J,N);if(C.lastQuery==J){L(N)}else{if(new RegExp(J,"i").test(C.lastQuery)&&D.timeoutId){var O=C.getCachedResultsForSimilarQuery(I,J);if(O){D.cancel();L(O)}}}};var E=this.getRequestUrl(H);B.ajax({url:E,data:F,dataType:K,success:G,error:G})},getRequestUrl:function(C){var D=this.cachedDefaultUrl||(this.cachedDefaultUrl=netflix.Link.url(this.DEFAULT_AUTOCOMPLETE_URL,null,netflix.Link.isSecure()));return(C&&(C.cloudUrl||C.autoCompleteUrl))||D},generateCacheName:function(F){var C=F.queryOptions;var E=0;if(C){var D=B.extend(true,{},C);delete D.prefix;delete D.term;E=this.hashCode(this.getRequestUrl(F))+this.hashCode(D)}return E.toString()},hashCode:function(D){var K=[],J=0;switch((typeof D).toLowerCase()){case"string":case"boolean":case"number":K.push(D.toString());break;default:switch(true){case (D instanceof Function):K.push("#Function");break;case (D instanceof Array):for(var F=0,G=D.length;F<G;F++){J+=this.hashCode(D[F])}break;case (D instanceof Object):for(var C in D){if(D.hasOwnProperty(C)){K.push(C,"#");J+=this.hashCode(D[C])}}break;default:K.push("undefined")}}var I=K.join("");for(var E=0,H=I.length;E<H;E++){J+=I.charCodeAt(E)}return J},isInCache:function(E,D){var C=this.getCache(E);return C&&C[D]},addToCache:function(F,D,E){var C=this.getCache(F);if(!C){this.cache[F]=C={}}if(!C[D]){this.size++}C[D]=E},getFromCache:function(E,D){if(this.isInCache(E,D)){var C=this.getCache(E);return C[D]}return null},getCache:function(C){return this.cache[C]},getCachedResultsForSimilarQuery:function(H,G){var E=this.getSimilarCachedQuery(H,G);if(!E){return null}var I=this.getFromCache(H,E),F=I.getSize(),C=I.filter(G),D=C.getSize();if(D<F&&D<this.MIN_MATCHES){return null}if(D==F){this.addToCache(H,G,this.getFromCache(H,E))}else{this.addToCache(H,G,C)}return this.getFromCache(H,G)},getSimilarCachedQuery:function(H,I){var D=null,K=null,E=this.cacheDirections.forward,G=this.cacheDirections.backward;if(!(E||G)){return null}var F=function(O,N,M){var P=O.length,L=N.length,Q=M?M.length:0;return(P>L&&(L>Q||P<Q)&&O.indexOf(N)!=-1)};var C=this.getCache(H);if(!!C){for(var J in C){if(C.hasOwnProperty(J)){if(E&&F(I,J,D)){D=J;if(J.length==I.length-1){break}}else{if(G&&F(J,I,K)){K=J;if(I.length==J.length-1){break}}}}}}return D||K||null}}})(jQuery,netflix.DebugConsole.log);
if(!netflix.search){netflix.search={}}netflix.search.AutoCompleteSearch=(function(D,G,C,A){var F=C.page,B=C.global,E={RESULTS_ID:"autoCompleteSearchResults",KEY_DOWN_EVENT:"keydown",currentInputId:null,originalQuery:null,Q_SEARCH_FIELD_ID:"q_searchField",INSERTION_ELEMENT_ID:"mainNavigation",FALLBACK_INSERTION_ELEMENT_ID:"global-search",SEARCH_RESULTS_WIDTH:0,SUPPRESS_DISPLAY:0,currentQueueTrkId:null,enhancement:2,clearResults:function(){var I=D("#"+E.RESULTS_ID);I.html("");H.lastQuery=null;E.currentInputId=null;H.lastSelectedItem=null;I.css("display","none");G.resetState()},sequenceNumber:0,requestTime:null,calculateCurrentRowIndex:function(I){var J=I&&I.closest("LI")||null;return J&&J.prevAll().andSelf().length||null}},H={timeoutId:null,MIN_QUERY_LENGTH:1,KEY_UP_EVENT:"keyup",FOCUS_EVENT:"focus",FOCUSED_CLASS:"goToItem-focused",UNFOCUSED_CLASS:"goToItem",BACKSPACE:"8",ESCAPE:"27",RETURN:"13",MAX_MATCHES:10,currentTrkId:null,lastQuery:null,stopPropagationConditions:{isAddMovieButton:function(I){return I.tagName=="A"&&I.className=="addlk"}},RESULTS_ID:"autoCompleteSearchResults",RESULTS_CLASSNAME:"autoCompleteSearchResults",SEARCH_FIELD_ID:"searchField",MAIN_BODY_ID:"main-body",SEARCH_URI:"Search",WATCHNOW_SEARCH_URI:"WiSearch",SEARCH_QUERY_PARAMS:{QUERY:"?v1=",TRACKID:"&trkid=",PREVIOUSLY_VIEWED:"&inPV=",LINK_CE:"&lnkce=",HASH_VALUE:"&hv=",ORIGINAL_QUERY:"&oq="},ADD_TO_Q_URI:"FromQueue/AddToQueue",ADD_TO_Q_PARAMS:{MOVIEID:"?movieid="},isWatchNowPage:false,getTarget:function(J){var I=(window.event?window.event.srcElement:J.target);if(!(I.parentNode&&I.parentNode.nodeType==1)){return null}if(I.nodeType==3||I.parentNode.tagName.toLowerCase()=="a"){I=I.parentNode}return I},onTextChanged:function(J){if(E.SUPPRESS_DISPLAY){E.SUPPRESS_DISPLAY=0;return }var I=H.getTarget(J);E.currentInputId=I.id;H.handleTextChange(I.id,I.value.replace(/^\s+/,""),J)},displayResults:function(J,N,M){var L,I,K,Q,P,O;if(M){if(M.getSize()){E.currentInputId=J;L=D("#"+E.RESULTS_ID);L.html(H.renderResults(N,M.getMovies(),"Movies","movie"));I=D("#"+J),K=D("#"+E.FALLBACK_INSERTION_ELEMENT_ID),Q=0;O=I.parents("#"+E.FALLBACK_INSERTION_ELEMENT_ID).length;if(O){I=K;Q=parseInt(K.css("margin-right"))-2}P=I.outerWidth()+E.SEARCH_RESULTS_WIDTH+Q;L.css("width",P);H.position(I,O);G.resetState();D(document).click(H.document_onclick)}else{E.clearResults()}}},position:function(P,M){var I=P,J=1,L=0;if(M){I=D("#"+E.FALLBACK_INSERTION_ELEMENT_ID);J=-1;L=1}var K=I.offset();if(B.IS_MTD&&document.documentElement.getBoundingClientRect){K=I[0].getBoundingClientRect()}var O=K.top+I.outerHeight()+J;var N=K.left+L;D("#"+E.RESULTS_ID).css({display:"block",top:O,left:N})},renderResults:function(N,M,J,O){var L=[];for(var K=0,I=Math.min(M.length,H.MAX_MATCHES);K<I;K++){L.push(H.renderResult(N,M[K],O,null,K+1))}if(M.length){L.unshift("<ol class='resultGroup resultGroup-"+O+"'>");L.push("</ol>")}return L.join("")},renderResult:function(L,K,M,J,I){return["<li class='searchResult searchResult-",M,"'>",'<h5><a class="goToItem" title="',H.escapeDelimiters(K&&K.title||K),'" id="',K.id,'" href="',H.toItemURL(K,I),'">',K&&K.title||K,"</a>","</h5>","</li>"].join("")},onWindowResize:function(){if("block"==D("#"+E.RESULTS_ID).css("display")){H.position(D("#"+H.SEARCH_FIELD_ID),false)}},handleTextChange:function(O,J,M){var L=G.getKeyCode(M);var K=!G.getHandlerForEvent(M);if(K){E.originalQuery=J}J=J.toLowerCase();if(H.lastQuery==J&&K){return }H.lastQuery=J;if(J.length>=H.MIN_QUERY_LENGTH){if(!L||L>31||L==H.RETURN||L==H.BACKSPACE||L==H.ESCAPE){if(!!G.getHandlerForEvent(M)){G.handleKeyEvent(M)}else{var I=(F&&F.AUTOCOMPLETE&&D.extend(true,{},F.AUTOCOMPLETE))||null;if(I){var N={prefix:J};if(O===E.Q_SEARCH_FIELD_ID){N.n=30;N.type="movie";I.cloudUrl=I.queueCloudUrl}D.extend(I.queryOptions,N)}E.requestTime=new Date().getTime();netflix.search.SearchResultCache.query(J,function(P){H.displayResults(O,J,P)},I||{})}}}else{if(!!G.getHandlerForEvent(M)){G.handleKeyEvent(M)}E.clearResults()}},document_onclick:function(M){var J=G.getTarget(M),L=E.currentInputId,N=D("#"+E.RESULTS_ID),I=M.target.tagName;if((L&&N.length&&N[0].contains(J))||(I=="BUTTON"||I=="INPUT")){}else{if(!J||J.id!=L&&J.id!=E.RESULTS_ID){D(document).unbind("click",H.document_onclick);E.clearResults();for(var K in H.stopPropagationConditions){if(H.stopPropagationConditions[K](J)){return false}}}}},searchResultsHTML:function(){return['<div id="',E.RESULTS_ID,'" class="',H.RESULTS_CLASSNAME,'"></div>'].join("")},getSearchURI:function(){var I=D("#"+E.currentInputId).closest("form"),J=I.attr("action");if(!I.length){return E.SEARCH_URI}if(!I.data("CACHED_URI")){I.data("CACHED_URI",J.substring(J.lastIndexOf("/")))}return I.data("CACHED_URI")},toItemURL:function(L,J){if(E.currentInputId===E.Q_SEARCH_FIELD_ID){var K=netflix.constants.global[netflix.Link.isSecure()?"CLOUD_ROOT_SECURE":"CLOUD_ROOT"];return netflix.XSRFSafeLink.url(K+"/"+H.ADD_TO_Q_URI,{movieid:L.id,trkid:E.currentQueueTrkId,qtype:"DD"},netflix.Link.isSecure())}else{var M=F.AUTOCOMPLETE,I=M&&M.autoCompleteResultUrl&&M.autoCompleteResultUrl+H.getSearchURI()||netflix.Link.url(H.getSearchURI(),null,netflix.Link.isSecure());return[I,H.SEARCH_QUERY_PARAMS.QUERY,H.encodeTitle(L&&L.title||L)].join("")}},encodeTitle:function(I){if(I){if(I.match("\\s&\\s")){return I.replace(/(\s)(&)(\s)/g,"$1%26$3")}else{if(I.match("\\s\\+\\s")){return I.replace(/(\s)(&)(\s)/g,"$1%2B$3")}}return I}return""},escapeDelimiters:function(I){return I.replace(/\"/g,'"')}};D(function(){var J=H.onTextChanged;D("input.autoCompleteSearchField").focus(J).keyup(J).keydown(J);var I=D("#"+E.INSERTION_ELEMENT_ID);if(!I.length){I=D("#"+E.FALLBACK_INSERTION_ELEMENT_ID)}I.append(D(H.searchResultsHTML()));D(window).resize(H.onWindowResize);if(undefined===G){G=netflix.search.SearchResultKeyHandler}D("#"+E.RESULTS_ID).appendTo(document.body)});return E})(jQuery,netflix.search.SearchResultKeyHandler,netflix.constants,netflix.search.SearchLogDefs,netflix.logging.Beacon,netflix.DebugConsole.log);netflix.search.SearchResultKeyHandler=(function(C,F,E,B,A){var G={CURRENT_FOCUS_INDEX:-1,FOCUSED_CLASS:"goToItem-focused",UNFOCUSED_CLASS:"goToItem",keyCodeMap:{DOWN_ARROW:40,UP_ARROW:38,ESCAPE:27,RETURN:13},KEY:{"40":"DOWN_ARROW","38":"UP_ARROW","27":"ESCAPE","13":"RETURN"},currentRow:null,handleEscape:function(H){netflix.search.AutoCompleteSearch.clearResults()},handleReturn:function(I){if(window.event){window.event.cancelBubble=true}else{I.stopPropagation()}if(F.KEY_DOWN_EVENT!=I.type){return }if(F.currentInputId==F.Q_SEARCH_FIELD_ID){var H=C("."+G.FOCUSED_CLASS,"#"+F.RESULTS_ID);if(!H.length){H=C("a:first","#"+F.RESULTS_ID)}I.preventDefault();if(H&&H.length){window.location.href=H[0].href}}},handleVerticalArrows:{computeCurrentRowIndex:function(I,H){if(G.keyCodeMap.DOWN_ARROW==I){if(G.CURRENT_FOCUS_INDEX>=0&&G.CURRENT_FOCUS_INDEX<(H-1)){G.CURRENT_FOCUS_INDEX++}else{if(G.CURRENT_FOCUS_INDEX==-1){G.CURRENT_FOCUS_INDEX=0}else{G.CURRENT_FOCUS_INDEX=-1}}}else{if(G.keyCodeMap.UP_ARROW==I){if(G.CURRENT_FOCUS_INDEX>0){G.CURRENT_FOCUS_INDEX--}else{if(G.CURRENT_FOCUS_INDEX==-1){G.CURRENT_FOCUS_INDEX=H-1}else{G.CURRENT_FOCUS_INDEX=-1}}}}return G.CURRENT_FOCUS_INDEX},computePreviousRowIndex:function(J,I){var H;if(G.keyCodeMap.UP_ARROW==J){if(G.CURRENT_FOCUS_INDEX==-1){H=0}else{if(G.CURRENT_FOCUS_INDEX==I-1){H=-1}else{H=G.CURRENT_FOCUS_INDEX+1}}}else{if(G.keyCodeMap.DOWN_ARROW==J){if(G.CURRENT_FOCUS_INDEX==-1){H=I-1}else{if(G.CURRENT_FOCUS_INDEX==0){H=-1}else{H=G.CURRENT_FOCUS_INDEX-1}}}}return H},locateRow:function(I,H){if(I>=0){return H[I]}},applyRowActions:function(I,K){for(var J=0,H=I.length;J<H;J++){I[J](K)}},eventHandler:function(O){var Q=D.getKeyCode(O);var J=C("#"+F.RESULTS_ID);if(J.css("display")!="none"&&F.KEY_DOWN_EVENT==O.type){var K=G.handleVerticalArrows;var L=C("#"+F.RESULTS_ID+" a");var P=L.length;var N=K.computeCurrentRowIndex(Q,P);var M=K.computePreviousRowIndex(Q,P);var I=K.locateRow(N,L);var H=K.locateRow(M,L);K.applyRowActions(K.previousFocusActions,H);K.applyRowActions(K.currentFocusActions,I)}},currentFocusActions:[function(I){var H=C("#"+F.currentInputId);if(I){I.className=G.FOCUSED_CLASS;H.val(decodeURIComponent(I.title));C("input[name=oq]").val(F.originalQuery);C("input[name=ac_posn]").val(F.calculateCurrentRowIndex(C(I)));G.currentRow=I}else{if(!H.length){H.val(F.originalQuery);F.resetAcPositionValue()}}}],previousFocusActions:[function(H){if(H){H.className=G.UNFOCUSED_CLASS}}]},keyHandlerMap:function(){return this.cachedKeyHandlerMap||(this.cachedKeyHandlerMap={UP_ARROW:G.handleVerticalArrows.eventHandler,DOWN_ARROW:G.handleVerticalArrows.eventHandler,ESCAPE:G.handleEscape,RETURN:G.handleReturn})}},D={getKeyCode:function(H){return window.event?window.event.keyCode:H.which},getTarget:function(I){var H=(window.event?window.event.srcElement:I.target);if(!(H.parentNode&&H.parentNode.nodeType==1)){return null}if(H.nodeType==3||H.parentNode.tagName.toLowerCase()=="a"){H=H.parentNode}return H},handleKeyEvent:function(I){var H=D.getHandlerForEvent(I);if(H){G.keyHandlerMap()[H](I)}},getHandlerForEvent:function(I){var H=D.getKeyCode(I);return(H&&G.KEY[H.toString()])||null},resetState:function(){G.CURRENT_FOCUS_INDEX=-1}};C(function(){if(undefined===F){F=netflix.search.AutoCompleteSearch}});return D})(jQuery,netflix.search.AutoCompleteSearch,netflix.constants.page,netflix.search.SearchLogDefs,netflix.DebugConsole.log);
netflix.namespace("netflix.queue");(function(A){netflix.queue.Announce=function(E,D,B,C){this.triggerSelector="#"+E;this.$trigger=A(this.triggerSelector).bind(this.EVENT_CLICK,{context:this},this.__fixScope__);this.$layer=A("#"+D);this.closeButtonSelector="."+B;this.contentUrl=C;this.content=null};netflix.queue.Announce.prototype={EVENT_CLICK:"click",EVENT_AJAXSUCCESS:"ajaxSuccess",EVENT_AJAXERROR:"ajaxError"};netflix.queue.Announce.prototype.__fixScope__=function(B){B.data.context.handleEvent.call(B.data.context,B.originalEvent||B)};netflix.queue.Announce.prototype.handleEvent=function(C){switch(C.type){case this.EVENT_CLICK:var B=A(C.target||C.srcElement);switch(true){case B.is(this.triggerSelector):this.showOverlay();break;case B.closest("a").is(this.closeButtonSelector):this.$layer.hide();break}C.preventDefault?C.preventDefault():C.returnValue=false;break;case this.EVENT_AJAXSUCCESS:this.content=C.data.html;this.$layer.html(this.content);A(this.closeButtonSelector,this.$layer).bind(this.EVENT_CLICK,{context:this},this.__fixScope__);this.showOverlay();break;case this.EVENT_AJAXERROR:window.location=this.$trigger.attr("href");break;default:break}};netflix.queue.Announce.prototype.showOverlay=function(){var B=this.$layer;if(B&&B.length){if(!this.content){this.__loadContent__()}else{var E=A(window),D=E.width()/2-B.outerWidth()/2,C=(E.height()/2-B.outerHeight()/2)+E.scrollTop();D=Math.max(0,D);C=Math.max(0,C);B.css({top:C+"px",left:D+"px"}).show()}}};netflix.queue.Announce.prototype.__loadContent__=function(){var B=this;A.ajax({url:this.contentUrl,dataType:"json",success:function(C){B.handleEvent({type:B.EVENT_AJAXSUCCESS,data:C})},error:function(C){B.handleEvent({type:B.EVENT_AJAXERROR,data:C})}})}})(jQuery);
netflix.namespace("netflix.queue");(function(D,C,B,A){netflix.queue.Tips=function(){this.announce=null};netflix.queue.Tips.prototype={LINK_SELECTOR:".q_tip_link"};netflix.queue.Tips.prototype.initialize=function(){D(this.LINK_SELECTOR).each(function(){var G=A[B.isSecure()?"CLOUD_ROOT_SECURE":"CLOUD_ROOT"],H=B.urlWithXSRF(G+"/QueueTip",{lnkctr:this.getAttribute("rel")});this.announce=new C(this.getAttribute("id"),"q_tip","closeBtn",H)});var E=D("#queue-dayonemessage");if(E&&E.length){var F=D(".anim #stepTwo",E);if(F&&F.length){window.setTimeout(function(){F.fadeIn(350,function(){window.setTimeout(function(){D(".anim #stepThree",E).fadeIn(350)},1000)})},1000)}}}})(jQuery,netflix.queue.Announce,netflix.Link,netflix.constants.global);
netflix.namespace("netflix.queue");(function(C,A,B){netflix.queue.HowToPopup=function(E,D,F){this.$popup=C("#"+E);this.$popupTarget=C(D);this.modalGlassSelector="#qtdModalGlass";this.$modalGlass=C(this.modalGlassSelector);this.closeButtonSelector=F;this.$closeTrigger=this.$modalGlass.add(this.closeButtonSelector);this.$closeTrigger.bind(this.EVENT_CLICK,{context:this},this.__fixScope__);this.show()};netflix.queue.HowToPopup.prototype={EVENT_CLICK:"click",TOP_FUDGE_FACTOR:5,LEFT_FUDGE_FACTOR:30.5};netflix.queue.HowToPopup.prototype.show=function(){var D=this.__getPosition__();if(D!=null){this.$popup.css(D).show();this.$modalGlass.show()}};netflix.queue.HowToPopup.prototype.hide=function(){this.$popup.hide();this.$modalGlass.hide()};netflix.queue.HowToPopup.prototype.handleEvent=function(E){switch(E.type){case this.EVENT_CLICK:var D=C(E.target||E.srcElement);switch(true){case !!D.closest(this.closeButtonSelector).length:this.__logEvent__({type:"closed"});break;case D.is(this.modalGlassSelector):this.__logEvent__({type:"dismissed"});break}this.hide();this.__stopEvent__(E);break;default:break}};netflix.queue.HowToPopup.prototype.__getPosition__=function(){if(this.$popupTarget&&this.$popupTarget.length){var D=this.$popupTarget.position();return{top:D.top-this.TOP_FUDGE_FACTOR,left:D.left+this.LEFT_FUDGE_FACTOR}}return null};netflix.queue.HowToPopup.prototype.__fixScope__=function(D){D.data.context.handleEvent.call(D.data.context,D.originalEvent||D)};netflix.queue.HowToPopup.prototype.__logEvent__=function(D){var E=B[A.isSecure()?"CLOUD_ROOT_SECURE":"CLOUD_ROOT"],G=A.urlWithXSRF(E+"/QueueHowTo"),F=C.extend({actionMethod:"qtdUpdate"},D);C.ajax({url:G,data:F,success:null,error:null,dataType:"json"})};netflix.queue.HowToPopup.prototype.__stopEvent__=function(D){D.preventDefault?D.preventDefault():D.returnValue=false}})(jQuery,netflix.Link,netflix.constants.global);
var QUpdater={changeHandler:function(A){var B="on"+A.type;if(typeof this[B]==="function"){this[B](A)}}};if(!Array.indexOf){Array.prototype.indexOf=function(B){for(var A=0;A<this.length;A++){if(this[A]===B){return A}}return -1}}(function(B,A,C){netflix.queue=B.extend(netflix.queue||{},{mouseOverRow:null,qType:null,init:function(){this.getNotifications();this.moveToTop.init();this.popups.init();this.highlight.init();this.paging.init();if(!!this.dnd){this.dnd.init()}else{var E=B("table.qtbl","#queue.dvd,#queue.instant");if(E.length===0){E=B("#qbody")}E.css("cursor","default")}B("#qbox").click(netflix.queue.deleteRow);this.i_id=this.drTemplate.indexOf("__ID__");this.i_msg=this.drTemplate.indexOf("__MESSAGE__");this.i_series=this.drTemplate.indexOf("__SERIESMSG__");this.i_undoURL=this.drTemplate.indexOf("__UNDOURL__");this.i_cssX=this.drTemplate.indexOf("__CSSEXTRA__");var D=B.browser.msie?"#qbox td.fm select":"#qbox";B(D).change(function(F){if(B(F.target).is("td.fm select")){updateFormat(F.target)}});this.xShipInit()},getNotifications:function(){var D=netflix.Link.url("/JSON/QNotify",null);B.ajax({url:D,dataType:"jsonp",jsonpCallback:"jsonp"+new Date().getTime(),success:this.showNotifications,error:this.notificationError})},showNotifications:function(E){if(E.status){var D=B("<div>");D.attr("id","pma").addClass("pma").html(E.html);B("#qtabs").before(D)}},notificationError:function(){},getMovieID:function(D){return D.attr("data-mid")},getMediaType:function(D){return D.attr("data-mediatype")},getQueueType:function(){if(this.qType===null){var E=B("#ftype");var D=(E.length===0)?"DD":E.val();this.qType=(D==="ED"?D:"DD")}return this.qType},getRowByID:function(D){var E=B("#R"+D);if(!E){return null}return E.parents("tr")},getTrkID:function(){return netflix.queue.undoTrkID},deleteRow:function(E){var F=netflix.queue;var G=B(E.target);if(!G.is("a.delbtn")){return }E.preventDefault();var D=G.attr("href");F.deleteRows_cmd(G.parents("tr"),D,C,function(H){var I=H.rowList;if(I==null){return }I.animate({opacity:"1"},"fast",function(){var J=B(E.target).parents("tr");B("a.undelete",I).click(function(K){K.preventDefault();F.addRows_cmd(J,F.addRowsCleanup)});B("a.removeall",I).click(function(K){K.preventDefault();F.removeSeries_cmd(J)})})})},deleteRows_cmd:function(I,D,J,G){var H=netflix.queue;var F=[];I.each(function(){var K=B(this);F.push(H.getMovieID(K));if(H.dropdownsOnTop){B("select",K).hide(0)}});I.animate({opacity:"0"},"fast").attr("data-deleted","1");var E={mvlist:F.join(",")};if(D.indexOf("qtype=")<0){E.qtype=H.getQueueType()}B.ajax({type:"GET",url:D,dataType:"json",data:E,error:H.ajaxError,success:H.deleteRowsSuccess,callbackData:{cleanup:G,rowList:I,checkSeries:J,retries:0}})},drTemplate:A?['<div class="rowmask',"__CSSEXTRA__",'" id="',"__ID__",'">',"__MESSAGE__",'<a href="',"__UNDOURL__",'" class="undelete action">Undo</a>',"__SERIESMSG__","</div>"]:['<div class="rowmask',"__CSSEXTRA__",'" id="',"__ID__",'">',"__MESSAGE__","</div>"],i_id:-1,i_msg:-1,i_series:-1,i_undoURL:-1,i_cssX:-1,deleteRowsSuccess:function(P){var E=netflix.queue;if(P.result!="success"){E.abortDelete(this.callbackData,P.actionErrors);return }var D=P.data;var T=E.drTemplate.slice(0);var I=null;var M=D.length;var U=100000;var G=null;for(var L=0;L<M;++L){var O=D[L];var N=O.movieID;var K=E.getRowByID(N);var Q=B("input.o",K).val();var F=E.getMediaType(K);if(O.status>=0){var R={actionMethod:"json",mvlist:N+"|"+Q+"|"+F,qtype:E.getQueueType(),trkid:E.getTrkID()};var J=netflix.XSRFSafeLink.url("Q/QAdd",R);var H="#";var S=(!!K.attr("series")&&E.getQueueType()!="ED");T[E.i_id]="PP"+N;T[E.i_msg]="<strong>"+O.title+"</strong> "+O.message;if(E.i_undoURL>=0){T[E.i_undoURL]=J}if(E.i_series>=0&&this.callbackData.checkSeries&&S){T[E.i_series]='<div>This movie is part of a series. Click here to&nbsp;<a class="removeall" class="serieshilite" href="'+H+'">Remove All</a></div>';T[E.i_cssX]=" series";E.hiliteSeries(K,true)}else{T[E.i_series]="";T[E.i_cssX]=""}B("td:last div.ddt",K).prepend(T.join(""));if(I===null){I=B(K)}else{I=I.add(K)}if(Q<U){U=Q;G=K}}}E.renumberRows(G,true);if(typeof this.callbackData.cleanup==="function"){this.callbackData.rowList=I;this.callbackData.cleanup(this.callbackData)}},abortDelete:function(D,F){var G=netflix.queue;var E=D.rowList;if(E==null||E.length==0){return }E.stop(true,false).fadeIn(0);alert(F.join("\n"))},addRows_cmd:function(H,D){var K=netflix.queue;var I=[];var F=0;var L=0;H.each(function(){var N=B(this);var O=parseInt(B("input.o",N).val(),10);if(isNaN(O)){O=0}if(O===L){O+=++F}else{L=O}var M=K.getMediaType(N);I.push(K.getMovieID(N)+"|"+O+"|"+M)});var E={actionMethod:"json",mvlist:I.join(","),qtype:K.getQueueType(),trkid:K.getTrkID()};var J=netflix.XSRFSafeLink.url("Q/QAdd",E);var G=netflix.namespace("netflix.constants.global");if(G.CLOUD_ROOT){J=netflix.XSRFSafeLink.url(G.CLOUD_ROOT+"/AddToQueue!undo");delete E.actionMethod}else{E={}}B.ajax({type:"GET",url:J,dataType:"json",data:E,error:K.ajaxError,success:K.addRowsSuccess,callbackData:{cleanup:D,rowList:H,retries:0}})},addRowsSuccess:function(P){var O=netflix.queue;if(P.result!="success"){O.abortAdd(this.callbackData,P.actionErrors);return }var J=P.data;var I=null;var L=J.length;var F=100000;var M=null;var G=[];for(var H=0;H<L;++H){var K=J[H];var D=K.movieID;var N=O.getRowByID(D);var E=B("input.o",N).val();if(K.status>=0){if(I===null){I=B(N)}else{I=I.add(N)}if(E&&E<F){F=E;M=N}}else{G.push(K.title+": "+K.message)}}if(G.length>0){alert(G.join("\n"))}if(typeof this.callbackData.cleanup==="function"){this.callbackData.minRow=M;this.callbackData.rowList=I;this.callbackData.cleanup(this.callbackData)}},abortAdd:function(D,E){alert(E.join("\n"))},addRowsCleanup:function(D){var F=netflix.queue;var E=D.rowList;if(E==null){return }B("div.rowmask",E).fadeOut(400).remove();E.removeAttr("data-deleted");if(F.dropdownsOnTop){B("select",E).show(0)}F.hiliteSeries(D.minRow,false);F.renumberRows(D.minRow)},renumberRows:function(D,H){if(D===null||D.length===0){return }var G=B("input.o",D);if(G.length===0){return }var E=G.val();if(!H){E++}var F=D.nextAll();F.each(function(){var J=B(".pr input",this);J.val(E);var I=B(" .dtc em",this);if(I.length>0){var K=I[0];K&&(K.qposition=E);var L=B(this).attr("data-deleted");if(!L||L!=="1"){E++}}})},removeDeletedRows:function(){var E=netflix.queue;var D=B("tr[deleted]","#qbox");if(D.length===0){return }E.hiliteSeries(D,false);D.remove()},hiliteSeries:function(E,D){if(!E){return }var F=E.attr("series");if(!F){return }if(D){E.siblings("tr.SX_"+F).addClass("serieshilite")}else{E.siblings("tr.SX_"+F).removeClass("serieshilite")}},removeSeries_cmd:function(E){var H=netflix.queue;if(!E){return }var I=E.attr("series");if(!I){return }var F=E.siblings(".SX_"+I);if(F.length===0){return }var D=netflix.XSRFSafeLink.url("/QueueDelete");var G=netflix.namespace("netflix.constants.global");if(G.CLOUD_ROOT){D=netflix.XSRFSafeLink.url(G.CLOUD_ROOT+"/QueueDelete")}H.deleteRows_cmd(F,D,false,function(J){var L=B("a.removeall",E);L.unbind("click").html("Restore All").click(function(M){M.preventDefault();H.restoreSeries_cmd(B(M.target).parents("tr"))});var K=J.rowList;if(K==null){return }K.animate({opacity:"1"},"fast",function(){B("a.undelete",K).click(function(M){M.preventDefault();var N=B(M.target).parents("tr");H.addRows_cmd(N,H.addRowsCleanup)})})})},restoreSeries_cmd:function(D){var F=netflix.queue;if(!D){return }var G=D.attr("series");if(!G){return }var E=B(".SX_"+G,"#qbox");if(E.length===0){return }F.addRows_cmd(E,F.addRowsCleanup)},ajaxError:function(E){var D=netflix.queue;if(++this.callbackData.retries>3){alert("unable to remove movie");return }B.ajax({type:"GET",url:this.url,dataType:"json",error:D.ajaxError,success:D.deleteSuccess,callbackData:this.callbackData})},updater:function(D){QUpdater.changeHandler(D)},noCSSBkgndForTR:B.browser.msie,dropdownsOnTop:(B.browser.msie&&parseInt(B.browser.version,10)===6),moveToTop:{idPattern:/^\d{1}_{1}\d+$/i,init:function(){if(netflix.queue.dnd){B("#qbody").click(function(H){var G=H.target;var F=G.nodeName.toUpperCase();var D=netflix.queue;var E=false;if(F==="A"&&G.className==="mvtopicon"){E=true}if((D.dnd&&D.dnd.dragging)||!G.id||!E){return }var K=netflix.queue.moveToTop;if(!K.idPattern.test(G.id)){return }H.preventDefault();var J=B(G);var I=netflix.queue;I.dnd.moveToTop(I.getRow(H.target),true)})}}},paging:{numPages:1,numPagesLoaded:1,requestTimeout:null,timeoutThreshold:45000,loadPending:false,qtype:location.href.getUrlAttribute("qtype")||"DD",init:function(){var F=B("#showmore");var E=B("#showall");if(E.length===0){return }var D=netflix.queue.paging;D.numPagesLoaded=parseInt(B("#qdata-numpagesloaded").val(),10);D.numPages=parseInt(B("#qdata-numpages").val(),10);F.attr("href","javascript:void(0);").click(function(){D.load("next")});E.attr("href","javascript:void(0);").click(function(){D.load("all")})},load:function(D){var E=netflix.queue.paging;if(E.loadPending===true){return }E.loadPending=true;E.requestTimeout=setTimeout(E.requestTimedOut,45000);B("#paging-busy").show();B.ajax(E.requestObject(D))},requestObject:function(D){var E=netflix.queue.paging;var F={qtype:E.qtype};F[D==="all"?"rp":"p"]=E.numPagesLoaded;return{type:"GET",dataType:"json",url:Link.url("Queue"),success:E.pageLoaded,error:E.ajaxError,data:F,callbackData:{action:D}}},pageLoaded:function(E){var D=netflix.queue.paging;var F=this.callbackData.action;clearTimeout(D.requestTimeout);D.requestTimeout=null;if(E.result==="success"){B("#qbody").append(E.html);D.numPagesLoaded++;if(F==="all"||D.numPagesLoaded===D.numPages){B("#paging-btns-container").hide();if(B.browser.msie){B("#qbr").css("zoom","1")}}if(netflix.queue.dnd){netflix.queue.dnd.paging.init(D.numPagesLoaded-1,F==="all")}}else{D.ajaxError(this)}D.loadPending=false;B("#paging-busy").hide()},ajaxError:function(D){netflix.queue.paging.loadPending=false;B("#showall, #showmore").hide();B("#paging-busy").hide();B("#paging-fail").show()},requestTimedOut:function(){netflix.queue.paging.ajaxError()}},popups:{init:function(){B("td.st a.serpop").click(function(D){netflix.queue.popups.openSeriesPopup();return false})},openSeriesPopup:function(){window.open(netflix.Link.url("Popup",{id:"5218"}),"SeriesPop","toolbars=0,scrollbars=0,location=0,statusbars=0,menubars=0,resizable=1,width=350,height=240")}},highlight:{idPattern:/\d/ig,isDesiredTarget:function(E,D){var F=netflix.queue.highlight.idPattern;if(D){F=D}return F.test(E.name)},init:function(){var F=netflix.queue;if(F.noCSSBkgndForTR&&!!F.dnd){var D=B("#inqueue-header-row")[0];B("#queue").mouseover(function(I){var H=F.getRow(I.target);if(!!F.dnd&&F.dnd.dragging){return }if(H&&H[0]!==D){B("td",H).css("background-color","#f6f6f6")}}).mouseout(function(I){var H=F.getRow(I.target);if(H&&H[0]!==D){B("td",H).css("background-color","")}})}B("#queue, #awaitingrelease").click(function(K){var M=B(K.target);if(M.is("input[type=checkbox]")&&netflix.queue.highlight.isDesiredTarget(K.target,/^R\d+$/i)){var L=M.parents("#queue").length===1;var I=netflix.queue.getRow(K.target);if(M.is(":checked")){I.removeClass("bgreorder");I.addClass("bgremove");netflix.queue.updater({type:(L?"queueChange":"awaitChange")})}else{I.removeClass("bgremove");if(L){var J=M.attr("name").substring("1");var N=B("#OR"+J,I);var H=B("#OP"+J,I);if(H.val()!==N.val()){I.addClass("bgreorder")}}}}});var G=function(L){var I=L||window.event;var K=I.target||I.srcElement;if(K.nodeName.toLowerCase()==="input"&&netflix.queue.highlight.isDesiredTarget(K,/^OR\d+$/i)){var H=netflix.queue.getRow(K);var J=B("td.rm input:checkbox",H);if(!J.is(":checked")){H.addClass("bgreorder");netflix.queue.updater({type:"queueChange"})}}};var E=function(M){var J=M||window.event;var L=J.target||J.srcElement;var K=B(L);if(K.is("input[type=text]")&&netflix.queue.highlight.isDesiredTarget(L,/^OR\d+$/i)){var I=netflix.queue.getRow(L);var H=B("td.pr input:hidden",I);if(H.val()===K.val()){I.removeClass("bgreorder")}}};B("#queue").each(function(){this.onfocusin=G;this.onfocusout=E;if(this.addEventListener){this.addEventListener("focus",G,true);this.addEventListener("blur",E,true)}})}},getRow:function(D){do{if(D.nodeName.toUpperCase()==="TR"){return B(D)}D=D.parentNode}while(D);return null},xShipInit:function(){var D=B("#extraDVDLink");if(D.length>0){D.click(function(F){F.preventDefault();var H=F.target;var I=B(H).offset();var G=I.top-10;var E=I.left-10;B("#xdvd_dialog").css({top:G+"px",left:E+"px"}).show();B("#xdvd_close").click(function(J){J.preventDefault();B("#xdvd_dialog").hide()})})}}});B(document).ready(function(){netflix.queue.init()});B(window).load(function(){if(!!netflix.queue.dnd){netflix.queue.dnd.initPostWindowLoad()}})})(jQuery,netflix.constants.global.QUEUE_UNDO,netflix.constants.global.QUEUE_ENABLE_REMOVE_ALL);function updateAvailability(A,B){if(A.length===0){return }var C=jQuery("div.sac,td.av",A[0]);C.html(B)}function updateFormat(G){var D=G.options[G.selectedIndex];var A=D.getAttribute("avail");var C=jQuery(G);updateAvailability(C.parents("tr"),D.getAttribute("avlabel"));A=(window.encodeURIComponent?encodeURIComponent(A):escape(A));var F={ftype:D.value,qimc_movieid:D.getAttribute("mvid"),avail:A,ncok:"true"};var B=netflix.Link.url("/QueueItemMediaChange");var E=netflix.namespace("netflix.constants.global");if(E.CLOUD_ROOT){B=E.CLOUD_ROOT+"/QueueItemMediaChange"}jQuery.get(B,F)}function rs_impl(D,B,C){var A=window.open("Popup?id="+D,"poppage7","toolbars=0,scrollbars=0,location=0,statusbars=0,menubars=0,resizable=0,width="+B+",height="+C)}function release_ship(){rs_impl(5249,366,345)}function release_ship_today(){rs_impl(1594,366,285)}function release_processing(){rs_impl(5324,366,350)}var recentReturns={returnBlock:"dvd-returns",textBlock:"showReturns",initialize:function(A){EventDispatcher.addEvent(dom,"ready",this.bindRatingEvent.bindEventListener(this));this.postcardHandler=new Postcard(this.returnBlock,A);this.postcardHandler.animate=false;this.postcardHandler.updateCount=function(B){jQuery.get(netflix.Link.url("/QueueRating"),{action:B,id:this.postcardId,ncok:"true"})}},toggle:function(){var B=$(this.returnBlock);var A=$(this.textBlock);if(!B||!A){return }if(B.style.display==="none"){B.style.display="";A.style.display="none";this.saveOpened()}else{this.saveClosed();A.style.display=""}if(!!netflix.queue.dnd){netflix.queue.dnd.recalc()}},saveReset:function(){this.postcardHandler.updateCount("reset")},saveClosed:function(){this.postcardHandler.close()},saveOpened:function(){this.postcardHandler.updateCount("open")},bindRatingEvent:function(){var C=$(this.returnBlock);if(!C){return false}var B=C.getElementsByTagName("img");for(var A=0;A<B.length;A++){if($$(B[A]).containsClass("star")||$$(B[A]).containsClass("obtn")){EventDispatcher.addEvent(B[A],"click",this.saveOpened.bindEventListener(this))}}}};
var UserAgent={matches:{},supports:{},uaDefs:{mac:/(\bmac.os\b|\bmac_)/i,windows:/\b(win95|win98|win 9x|winnt|windows)\b/i,x11:/\bx11\b/i,nix:/\b(unix|linux|x11|bsd)\b/i,vista:/NT\s*6.0/,xp:/NT\s*5\.1/,xpsp2:/NT\s*5\.1\s?;\s*SV1/,iewin:/msie(.*)?windows/i,iewinlt7:/msie [1-6](.*)?windows/i,iewin7:/msie 7(.*)?windows/i,iewin6:/msie 6(.*)?windows/i,iewin55:/msie 5\.5(.*)?windows/i,iewin5:/msie 5\.0(.*)?windows/i,iewinold:/msie [1-4](.*)?windows/i,iemac:/msie 5(.*)?mac/i,ns4:/netscape 4/i,safari:/(safari|applewebkit)/i,khtml:/(konqueror|khtml|safari|webkit)/i,opera:/opera/i,opera9:/opera\/9/i,firefox:/firefox/i,firefox1dot0:/firefox\/1\.0/i,firefox1dot5:/firefox\/1\.5/i,firefox2dot0:/firefox\/2/i,ipad:/iPad/,iphone:/iPhone/,ipod:/iPod/},featureDefs:{pngAlpha:function(){var A=UserAgent.matches;return A.khtml||A.opera||A.gecko||A.iewin&&!(A.iewinlt7)},pngAlphaIEWin:function(){var A=UserAgent.matches;return A.iewin&&!(A.iewin5||A.iewinold)},elementAlpha:function(){var A=UserAgent.matches;return A.khtml||A.opera9||A.gecko||(A.iewin&&!A.iewinold)},elementAlphaIEWin:function(){return UserAgent.supports.elementAlpha&&UserAgent.matches.iewin},fixedPosition:function(){var A=UserAgent.matches;return !A.iewin&&(A.gecko||A.khtml||A.opera)},activeX:function(){if(!window.ActiveXObject){return false}try{new ActiveXObject("Msxml2.XMLHTTP");return true}catch(A){return false}}},init:function(){var A=this.matches;var D=function(E,F){A[E]=F};for(var C in this.uaDefs){D(C,this.uaDefs[C].test(navigator.userAgent))}D("gecko",!A.khtml&&!A.opera&&/(firefox|camino|gecko)/i.test(navigator.userAgent));for(var B in this.featureDefs){this.supports[B]=this.featureDefs[B]()}Browser={MSIE:function(){return UserAgent.matches.iewin}};isMacIE=this.matches.iemac;isSafari=this.matches.safari;isOpera=this.matches.opera},addSupportedFeature:function(A,B){this.supports[A]=B}};var appVers=navigator.appVersion;UserAgent.init();
/*
 * jQuery UI Mouse 1.8.8
 *
 * Copyright 2010, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Mouse
 *
 * Depends:
 *	jquery.ui.widget.js
 */
(function(A,B){A.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var C=this;this.element.bind("mousedown."+this.widgetName,function(D){return C._mouseDown(D)}).bind("click."+this.widgetName,function(D){if(true===A.data(D.target,C.widgetName+".preventClickEvent")){A.removeData(D.target,C.widgetName+".preventClickEvent");D.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(E){E.originalEvent=E.originalEvent||{};if(E.originalEvent.mouseHandled){return }(this._mouseStarted&&this._mouseUp(E));this._mouseDownEvent=E;var D=this,F=(E.which==1),C=(typeof this.options.cancel=="string"?A(E.target).parents().add(E.target).filter(this.options.cancel).length:false);if(!F||C||!this._mouseCapture(E)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){D.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(E)&&this._mouseDelayMet(E)){this._mouseStarted=(this._mouseStart(E)!==false);if(!this._mouseStarted){E.preventDefault();return true}}this._mouseMoveDelegate=function(G){return D._mouseMove(G)};this._mouseUpDelegate=function(G){return D._mouseUp(G)};A(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);E.preventDefault();E.originalEvent.mouseHandled=true;return true},_mouseMove:function(C){if(A.browser.msie&&!(document.documentMode>=9)&&!C.button){return this._mouseUp(C)}if(this._mouseStarted){this._mouseDrag(C);return C.preventDefault()}if(this._mouseDistanceMet(C)&&this._mouseDelayMet(C)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,C)!==false);(this._mouseStarted?this._mouseDrag(C):this._mouseUp(C))}return !this._mouseStarted},_mouseUp:function(C){A(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(C.target==this._mouseDownEvent.target){A.data(C.target,this.widgetName+".preventClickEvent",true)}this._mouseStop(C)}return false},_mouseDistanceMet:function(C){return(Math.max(Math.abs(this._mouseDownEvent.pageX-C.pageX),Math.abs(this._mouseDownEvent.pageY-C.pageY))>=this.options.distance)},_mouseDelayMet:function(C){return this.mouseDelayMet},_mouseStart:function(C){},_mouseDrag:function(C){},_mouseStop:function(C){},_mouseCapture:function(C){return true}})})(jQuery);
(function(A,B){A.widget("ui.draggable",A.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){if(this.options.helper=="original"&&!(/^(?:r|a|f)/).test(this.element.css("position"))){this.element[0].style.position="relative"}(this.options.addClasses&&this.element.addClass("ui-draggable"));(this.options.disabled&&this.element.addClass("ui-draggable-disabled"));this._mouseInit()},destroy:function(){if(!this.element.data("draggable")){return }this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this},_mouseCapture:function(C){var D=this.options;if(this.helper||D.disabled||A(C.target).is(".ui-resizable-handle")){return false}this.handle=this._getHandle(C);if(!this.handle){return false}return true},_mouseStart:function(C){var D=this.options;this.helper=this._createHelper(C);this._cacheHelperProportions();if(A.ui.ddmanager){A.ui.ddmanager.current=this}this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};A.extend(this.offset,{click:{left:C.pageX-this.offset.left,top:C.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(C);this.originalPageX=C.pageX;this.originalPageY=C.pageY;(D.cursorAt&&this._adjustOffsetFromHelper(D.cursorAt));if(D.containment){this._setContainment()}if(this._trigger("start",C)===false){this._clear();return false}this._cacheHelperProportions();if(A.ui.ddmanager&&!D.dropBehaviour){A.ui.ddmanager.prepareOffsets(this,C)}this.helper.addClass("ui-draggable-dragging");this._mouseDrag(C,true);return true},_mouseDrag:function(C,E){this.position=this._generatePosition(C);this.positionAbs=this._convertPositionTo("absolute");if(!E){var D=this._uiHash();if(this._trigger("drag",C,D)===false){this._mouseUp({});return false}this.position=D.position}if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}if(A.ui.ddmanager){A.ui.ddmanager.drag(this,C)}return false},_mouseStop:function(D){var E=false;if(A.ui.ddmanager&&!this.options.dropBehaviour){E=A.ui.ddmanager.drop(this,D)}if(this.dropped){E=this.dropped;this.dropped=false}if(!this.element[0]||!this.element[0].parentNode){return false}if((this.options.revert=="invalid"&&!E)||(this.options.revert=="valid"&&E)||this.options.revert===true||(A.isFunction(this.options.revert)&&this.options.revert.call(this.element,E))){var C=this;A(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(C._trigger("stop",D)!==false){C._clear()}})}else{if(this._trigger("stop",D)!==false){this._clear()}}return false},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp({})}else{this._clear()}return this},_getHandle:function(C){var D=!this.options.handle||!A(this.options.handle,this.element).length?true:false;A(this.options.handle,this.element).find("*").andSelf().each(function(){if(this==C.target){D=true}});return D},_createHelper:function(D){var E=this.options;var C=A.isFunction(E.helper)?A(E.helper.apply(this.element[0],[D])):(E.helper=="clone"?this.element.clone():this.element);if(!C.parents("body").length){C.appendTo((E.appendTo=="parent"?this.element[0].parentNode:E.appendTo))}if(C[0]!=this.element[0]&&!(/(fixed|absolute)/).test(C.css("position"))){C.css("position","absolute")}return C},_adjustOffsetFromHelper:function(C){if(typeof C=="string"){C=C.split(" ")}if(A.isArray(C)){C={left:+C[0],top:+C[1]||0}}if("left" in C){this.offset.click.left=C.left+this.margins.left}if("right" in C){this.offset.click.left=this.helperProportions.width-C.right+this.margins.left}if("top" in C){this.offset.click.top=C.top+this.margins.top}if("bottom" in C){this.offset.click.top=this.helperProportions.height-C.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var C=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&A.ui.contains(this.scrollParent[0],this.offsetParent[0])){C.left+=this.scrollParent.scrollLeft();C.top+=this.scrollParent.scrollTop()}if((this.offsetParent[0]==document.body)||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&A.browser.msie)){C={top:0,left:0}}return{top:C.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:C.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var C=this.element.position();return{top:C.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:C.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.element.css("marginLeft"),10)||0),top:(parseInt(this.element.css("marginTop"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var F=this.options;if(F.containment=="parent"){F.containment=this.helper[0].parentNode}if(F.containment=="document"||F.containment=="window"){this.containment=[(F.containment=="document"?0:A(window).scrollLeft())-this.offset.relative.left-this.offset.parent.left,(F.containment=="document"?0:A(window).scrollTop())-this.offset.relative.top-this.offset.parent.top,(F.containment=="document"?0:A(window).scrollLeft())+A(F.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(F.containment=="document"?0:A(window).scrollTop())+(A(F.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!(/^(document|window|parent)$/).test(F.containment)&&F.containment.constructor!=Array){var D=A(F.containment)[0];if(!D){return }var E=A(F.containment).offset();var C=(A(D).css("overflow")!="hidden");this.containment=[E.left+(parseInt(A(D).css("borderLeftWidth"),10)||0)+(parseInt(A(D).css("paddingLeft"),10)||0)-this.margins.left,E.top+(parseInt(A(D).css("borderTopWidth"),10)||0)+(parseInt(A(D).css("paddingTop"),10)||0)-this.margins.top,E.left+(C?Math.max(D.scrollWidth,D.offsetWidth):D.offsetWidth)-(parseInt(A(D).css("borderLeftWidth"),10)||0)-(parseInt(A(D).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,E.top+(C?Math.max(D.scrollHeight,D.offsetHeight):D.offsetHeight)-(parseInt(A(D).css("borderTopWidth"),10)||0)-(parseInt(A(D).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}else{if(F.containment.constructor==Array){this.containment=F.containment}}},_convertPositionTo:function(F,H){if(!H){H=this.position}var D=F=="absolute"?1:-1;var E=this.options,C=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&A.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,G=(/(html|body)/i).test(C[0].tagName);return{top:(H.top+this.offset.relative.top*D+this.offset.parent.top*D-(A.browser.safari&&A.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(G?0:C.scrollTop()))*D)),left:(H.left+this.offset.relative.left*D+this.offset.parent.left*D-(A.browser.safari&&A.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():G?0:C.scrollLeft())*D))}},_generatePosition:function(F){var I=this.options,C=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&A.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,J=(/(html|body)/i).test(C[0].tagName);var E=F.pageX;var D=F.pageY;if(this.originalPosition){if(this.containment){if(F.pageX-this.offset.click.left<this.containment[0]){E=this.containment[0]+this.offset.click.left}if(F.pageY-this.offset.click.top<this.containment[1]){D=this.containment[1]+this.offset.click.top}if(F.pageX-this.offset.click.left>this.containment[2]){E=this.containment[2]+this.offset.click.left}if(F.pageY-this.offset.click.top>this.containment[3]){D=this.containment[3]+this.offset.click.top}}if(I.grid){var H=this.originalPageY+Math.round((D-this.originalPageY)/I.grid[1])*I.grid[1];D=this.containment?(!(H-this.offset.click.top<this.containment[1]||H-this.offset.click.top>this.containment[3])?H:(!(H-this.offset.click.top<this.containment[1])?H-I.grid[1]:H+I.grid[1])):H;var G=this.originalPageX+Math.round((E-this.originalPageX)/I.grid[0])*I.grid[0];E=this.containment?(!(G-this.offset.click.left<this.containment[0]||G-this.offset.click.left>this.containment[2])?G:(!(G-this.offset.click.left<this.containment[0])?G-I.grid[0]:G+I.grid[0])):G}}return{top:(D-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(A.browser.safari&&A.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(J?0:C.scrollTop())))),left:(E-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(A.browser.safari&&A.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():J?0:C.scrollLeft())))}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");if(this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval){this.helper.remove()}this.helper=null;this.cancelHelperRemoval=false},_trigger:function(C,D,E){E=E||this._uiHash();A.ui.plugin.call(this,C,[D,E]);if(C=="drag"){this.positionAbs=this._convertPositionTo("absolute")}return A.Widget.prototype._trigger.call(this,C,D,E)},plugins:{},_uiHash:function(C){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});A.extend(A.ui.draggable,{version:"1.8.8"});A.ui.plugin.add("draggable","connectToSortable",{start:function(D,F){var E=A(this).data("draggable"),G=E.options,C=A.extend({},F,{item:E.element});E.sortables=[];A(G.connectToSortable).each(function(){var H=A.data(this,"sortable");if(H&&!H.options.disabled){E.sortables.push({instance:H,shouldRevert:H.options.revert});H._refreshItems();H._trigger("activate",D,C)}})},stop:function(D,F){var E=A(this).data("draggable"),C=A.extend({},F,{item:E.element});A.each(E.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;E.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert){this.instance.options.revert=true}this.instance._mouseStop(D);this.instance.options.helper=this.instance.options._helper;if(E.options.helper=="original"){this.instance.currentItem.css({top:"auto",left:"auto"})}}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",D,C)}})},drag:function(D,G){var F=A(this).data("draggable"),C=this;var E=function(J){var O=this.offset.click.top,N=this.offset.click.left;var H=this.positionAbs.top,L=this.positionAbs.left;var K=J.height,M=J.width;var P=J.top,I=J.left;return A.ui.isOver(H+O,L+N,P,I,K,M)};A.each(F.sortables,function(H){this.instance.positionAbs=F.positionAbs;this.instance.helperProportions=F.helperProportions;this.instance.offset.click=F.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=A(C).clone().appendTo(this.instance.element).data("sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return G.helper[0]};D.target=this.instance.currentItem[0];this.instance._mouseCapture(D,true);this.instance._mouseStart(D,true,true);this.instance.offset.click.top=F.offset.click.top;this.instance.offset.click.left=F.offset.click.left;this.instance.offset.parent.left-=F.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=F.offset.parent.top-this.instance.offset.parent.top;F._trigger("toSortable",D);F.dropped=this.instance.element;F.currentItem=F.element;this.instance.fromOutside=F}if(this.instance.currentItem){this.instance._mouseDrag(D)}}else{if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",D,this.instance._uiHash(this.instance));this.instance._mouseStop(D,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();if(this.instance.placeholder){this.instance.placeholder.remove()}F._trigger("fromSortable",D);F.dropped=false}}})}});A.ui.plugin.add("draggable","cursor",{start:function(D,E){var C=A("body"),F=A(this).data("draggable").options;if(C.css("cursor")){F._cursor=C.css("cursor")}C.css("cursor",F.cursor)},stop:function(C,D){var E=A(this).data("draggable").options;if(E._cursor){A("body").css("cursor",E._cursor)}}});A.ui.plugin.add("draggable","iframeFix",{start:function(C,D){var E=A(this).data("draggable").options;A(E.iframeFix===true?"iframe":E.iframeFix).each(function(){A('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css(A(this).offset()).appendTo("body")})},stop:function(C,D){A("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}});A.ui.plugin.add("draggable","opacity",{start:function(D,E){var C=A(E.helper),F=A(this).data("draggable").options;if(C.css("opacity")){F._opacity=C.css("opacity")}C.css("opacity",F.opacity)},stop:function(C,D){var E=A(this).data("draggable").options;if(E._opacity){A(D.helper).css("opacity",E._opacity)}}});A.ui.plugin.add("draggable","scroll",{start:function(D,E){var C=A(this).data("draggable");if(C.scrollParent[0]!=document&&C.scrollParent[0].tagName!="HTML"){C.overflowOffset=C.scrollParent.offset()}},drag:function(E,F){var D=A(this).data("draggable"),G=D.options,C=false;if(D.scrollParent[0]!=document&&D.scrollParent[0].tagName!="HTML"){if(!G.axis||G.axis!="x"){if((D.overflowOffset.top+D.scrollParent[0].offsetHeight)-E.pageY<G.scrollSensitivity){D.scrollParent[0].scrollTop=C=D.scrollParent[0].scrollTop+G.scrollSpeed}else{if(E.pageY-D.overflowOffset.top<G.scrollSensitivity){D.scrollParent[0].scrollTop=C=D.scrollParent[0].scrollTop-G.scrollSpeed}}}if(!G.axis||G.axis!="y"){if((D.overflowOffset.left+D.scrollParent[0].offsetWidth)-E.pageX<G.scrollSensitivity){D.scrollParent[0].scrollLeft=C=D.scrollParent[0].scrollLeft+G.scrollSpeed}else{if(E.pageX-D.overflowOffset.left<G.scrollSensitivity){D.scrollParent[0].scrollLeft=C=D.scrollParent[0].scrollLeft-G.scrollSpeed}}}}else{if(!G.axis||G.axis!="x"){if(E.pageY-A(document).scrollTop()<G.scrollSensitivity){C=A(document).scrollTop(A(document).scrollTop()-G.scrollSpeed)}else{if(A(window).height()-(E.pageY-A(document).scrollTop())<G.scrollSensitivity){C=A(document).scrollTop(A(document).scrollTop()+G.scrollSpeed)}}}if(!G.axis||G.axis!="y"){if(E.pageX-A(document).scrollLeft()<G.scrollSensitivity){C=A(document).scrollLeft(A(document).scrollLeft()-G.scrollSpeed)}else{if(A(window).width()-(E.pageX-A(document).scrollLeft())<G.scrollSensitivity){C=A(document).scrollLeft(A(document).scrollLeft()+G.scrollSpeed)}}}}if(C!==false&&A.ui.ddmanager&&!G.dropBehaviour){A.ui.ddmanager.prepareOffsets(D,E)}}});A.ui.plugin.add("draggable","snap",{start:function(D,E){var C=A(this).data("draggable"),F=C.options;C.snapElements=[];A(F.snap.constructor!=String?(F.snap.items||":data(draggable)"):F.snap).each(function(){var H=A(this);var G=H.offset();if(this!=C.element[0]){C.snapElements.push({item:this,width:H.outerWidth(),height:H.outerHeight(),top:G.top,left:G.left})}})},drag:function(O,L){var F=A(this).data("draggable"),M=F.options;var S=M.snapTolerance;var R=L.offset.left,Q=R+F.helperProportions.width,E=L.offset.top,D=E+F.helperProportions.height;for(var P=F.snapElements.length-1;P>=0;P--){var N=F.snapElements[P].left,K=N+F.snapElements[P].width,J=F.snapElements[P].top,U=J+F.snapElements[P].height;if(!((N-S<R&&R<K+S&&J-S<E&&E<U+S)||(N-S<R&&R<K+S&&J-S<D&&D<U+S)||(N-S<Q&&Q<K+S&&J-S<E&&E<U+S)||(N-S<Q&&Q<K+S&&J-S<D&&D<U+S))){if(F.snapElements[P].snapping){(F.options.snap.release&&F.options.snap.release.call(F.element,O,A.extend(F._uiHash(),{snapItem:F.snapElements[P].item})))}F.snapElements[P].snapping=false;continue}if(M.snapMode!="inner"){var C=Math.abs(J-D)<=S;var T=Math.abs(U-E)<=S;var H=Math.abs(N-Q)<=S;var I=Math.abs(K-R)<=S;if(C){L.position.top=F._convertPositionTo("relative",{top:J-F.helperProportions.height,left:0}).top-F.margins.top}if(T){L.position.top=F._convertPositionTo("relative",{top:U,left:0}).top-F.margins.top}if(H){L.position.left=F._convertPositionTo("relative",{top:0,left:N-F.helperProportions.width}).left-F.margins.left}if(I){L.position.left=F._convertPositionTo("relative",{top:0,left:K}).left-F.margins.left}}var G=(C||T||H||I);if(M.snapMode!="outer"){var C=Math.abs(J-E)<=S;var T=Math.abs(U-D)<=S;var H=Math.abs(N-R)<=S;var I=Math.abs(K-Q)<=S;if(C){L.position.top=F._convertPositionTo("relative",{top:J,left:0}).top-F.margins.top}if(T){L.position.top=F._convertPositionTo("relative",{top:U-F.helperProportions.height,left:0}).top-F.margins.top}if(H){L.position.left=F._convertPositionTo("relative",{top:0,left:N}).left-F.margins.left}if(I){L.position.left=F._convertPositionTo("relative",{top:0,left:K-F.helperProportions.width}).left-F.margins.left}}if(!F.snapElements[P].snapping&&(C||T||H||I||G)){(F.options.snap.snap&&F.options.snap.snap.call(F.element,O,A.extend(F._uiHash(),{snapItem:F.snapElements[P].item})))}F.snapElements[P].snapping=(C||T||H||I||G)}}});A.ui.plugin.add("draggable","stack",{start:function(D,E){var G=A(this).data("draggable").options;var F=A.makeArray(A(G.stack)).sort(function(I,H){return(parseInt(A(I).css("zIndex"),10)||0)-(parseInt(A(H).css("zIndex"),10)||0)});if(!F.length){return }var C=parseInt(F[0].style.zIndex)||0;A(F).each(function(H){this.style.zIndex=C+H});this[0].style.zIndex=C+F.length}});A.ui.plugin.add("draggable","zIndex",{start:function(D,E){var C=A(E.helper),F=A(this).data("draggable").options;if(C.css("zIndex")){F._zIndex=C.css("zIndex")}C.css("zIndex",F.zIndex)},stop:function(C,D){var E=A(this).data("draggable").options;if(E._zIndex){A(D.helper).css("zIndex",E._zIndex)}}})})(jQuery);
(function(A,B){A.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect"},_create:function(){var D=this.options,C=D.accept;this.isover=0;this.isout=1;this.accept=A.isFunction(C)?C:function(E){return E.is(C)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};A.ui.ddmanager.droppables[D.scope]=A.ui.ddmanager.droppables[D.scope]||[];A.ui.ddmanager.droppables[D.scope].push(this);(D.addClasses&&this.element.addClass("ui-droppable"))},destroy:function(){var C=A.ui.ddmanager.droppables[this.options.scope];for(var D=0;D<C.length;D++){if(C[D]==this){C.splice(D,1)}}this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable");return this},_setOption:function(C,D){if(C=="accept"){this.accept=A.isFunction(D)?D:function(E){return E.is(D)}}A.Widget.prototype._setOption.apply(this,arguments)},_activate:function(D){var C=A.ui.ddmanager.current;if(this.options.activeClass){this.element.addClass(this.options.activeClass)}(C&&this._trigger("activate",D,this.ui(C)))},_deactivate:function(D){var C=A.ui.ddmanager.current;if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}(C&&this._trigger("deactivate",D,this.ui(C)))},_over:function(D){var C=A.ui.ddmanager.current;if(!C||(C.currentItem||C.element)[0]==this.element[0]){return }if(this.accept.call(this.element[0],(C.currentItem||C.element))){if(this.options.hoverClass){this.element.addClass(this.options.hoverClass)}this._trigger("over",D,this.ui(C))}},_out:function(D){var C=A.ui.ddmanager.current;if(!C||(C.currentItem||C.element)[0]==this.element[0]){return }if(this.accept.call(this.element[0],(C.currentItem||C.element))){if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("out",D,this.ui(C))}},_drop:function(D,E){var C=E||A.ui.ddmanager.current;if(!C||(C.currentItem||C.element)[0]==this.element[0]){return false}var F=false;this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var G=A.data(this,"droppable");if(G.options.greedy&&!G.options.disabled&&G.options.scope==C.options.scope&&G.accept.call(G.element[0],(C.currentItem||C.element))&&A.ui.intersect(C,A.extend(G,{offset:G.element.offset()}),G.options.tolerance)){F=true;return false}});if(F){return false}if(this.accept.call(this.element[0],(C.currentItem||C.element))){if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("drop",D,this.ui(C));return this.element}return false},ui:function(C){return{draggable:(C.currentItem||C.element),helper:C.helper,position:C.position,offset:C.positionAbs}}});A.extend(A.ui.droppable,{version:"1.8.8"});A.ui.intersect=function(P,J,N){if(!J.offset){return false}var E=(P.positionAbs||P.position.absolute).left,D=E+P.helperProportions.width,M=(P.positionAbs||P.position.absolute).top,L=M+P.helperProportions.height;var G=J.offset.left,C=G+J.proportions.width,O=J.offset.top,K=O+J.proportions.height;switch(N){case"fit":return(G<=E&&D<=C&&O<=M&&L<=K);break;case"intersect":return(G<E+(P.helperProportions.width/2)&&D-(P.helperProportions.width/2)<C&&O<M+(P.helperProportions.height/2)&&L-(P.helperProportions.height/2)<K);break;case"pointer":var H=((P.positionAbs||P.position.absolute).left+(P.clickOffset||P.offset.click).left),I=((P.positionAbs||P.position.absolute).top+(P.clickOffset||P.offset.click).top),F=A.ui.isOver(I,H,O,G,J.proportions.height,J.proportions.width);return F;break;case"touch":return((M>=O&&M<=K)||(L>=O&&L<=K)||(M<O&&L>K))&&((E>=G&&E<=C)||(D>=G&&D<=C)||(E<G&&D>C));break;default:return false;break}};A.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(F,H){var C=A.ui.ddmanager.droppables[F.options.scope]||[];var G=H?H.type:null;var I=(F.currentItem||F.element).find(":data(droppable)").andSelf();droppablesLoop:for(var E=0;E<C.length;E++){if(C[E].options.disabled||(F&&!C[E].accept.call(C[E].element[0],(F.currentItem||F.element)))){continue}for(var D=0;D<I.length;D++){if(I[D]==C[E].element[0]){C[E].proportions.height=0;continue droppablesLoop}}C[E].visible=C[E].element.css("display")!="none";if(!C[E].visible){continue}C[E].offset=C[E].element.offset();C[E].proportions={width:C[E].element[0].offsetWidth,height:C[E].element[0].offsetHeight};if(G=="mousedown"){C[E]._activate.call(C[E],H)}}},drop:function(C,D){var E=false;A.each(A.ui.ddmanager.droppables[C.options.scope]||[],function(){if(!this.options){return }if(!this.options.disabled&&this.visible&&A.ui.intersect(C,this,this.options.tolerance)){E=E||this._drop.call(this,D)}if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],(C.currentItem||C.element))){this.isout=1;this.isover=0;this._deactivate.call(this,D)}});return E},drag:function(C,D){if(C.options.refreshPositions){A.ui.ddmanager.prepareOffsets(C,D)}A.each(A.ui.ddmanager.droppables[C.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return }var F=A.ui.intersect(C,this,this.options.tolerance);var H=!F&&this.isover==1?"isout":(F&&this.isover==0?"isover":null);if(!H){return }var G;if(this.options.greedy){var E=this.element.parents(":data(droppable):eq(0)");if(E.length){G=A.data(E[0],"droppable");G.greedyChild=(H=="isover"?1:0)}}if(G&&H=="isover"){G.isover=0;G.isout=1;G._out.call(G,D)}this[H]=1;this[H=="isout"?"isover":"isout"]=0;this[H=="isover"?"_over":"_out"].call(this,D);if(G&&H=="isout"){G.isout=0;G.isover=1;G._over.call(G,D)}})}}})(jQuery);
(function(A){netflix.fang=function(B){var C=A.extend({id:"fang"+new Date().getTime(),visibleborder:"bottom",color:"#000000",bgcolor:"transparent",width:{t:10,l:10,b:10,r:10},opacity:0.8},B||{});return{ui:A("<div>").attr("id",C.id).css({"border-style":"solid",overflow:"hidden",opacity:C.opacity,"border-left-width":C.width.l,"border-top-width":C.width.t,"border-bottom-width":C.width.b,"border-right-width":C.width.r,"border-color":C.bgcolor}).css("border-"+C.visibleborder+"-color",C.color).width(0).height(0),width:C.width.l+C.width.r,height:C.width.t+C.width.b}};netflix.queue.dnd={helperTable:null,dragging:false,nontstandardrows:{},startingOffset:{},qType:(location.href.getUrlAttribute("qtype")==="ED"?"ED":"DD"),init:function(){var B=A("#qbox");if(B===null||B.length===0){A(document.body).append(this.dropMetaData.lguide.ui).append(this.dropMetaData.rguide.ui)}else{B.append(this.dropMetaData.lguide.ui).append(this.dropMetaData.rguide.ui)}netflix.queue.dnd.doJqueryPatches();netflix.queue.dnd.getFirstRow().attr("id","firstqitem")},recalc:function(){netflix.queue.dnd.startingOffset=netflix.queue.dnd.getFirstRow().offset()},initPostWindowLoad:function(){var C=A("em","#queue").filter(function(){return this.parentNode&&this.parentNode.parentNode&&this.parentNode.parentNode.className==="dtc"});var B=A("th.dtc em","#inqueue-header-row");var E=B.add(C);var F=E.length;if(F>1){var H=netflix.queue.dnd;H.annotateDropTargetDomElements(E);var D=function(I){A.Widget.prototype._skipTrigger=true;A("tr:not(.nondraggable)","#queue").draggable(H.dragMetaData);A.Widget.prototype._skipTrigger=false;setTimeout(I,1)};var G=function(){A.Widget.prototype._skipTrigger=true;E.droppable(H.dropMetaData);A.Widget.prototype._skipTrigger=false};setTimeout(function(){D(G)},1)}},annotateDropTargetDomElements:function(K,D){if(arguments.length===1){D=0}var F=netflix.queue.dnd;var C=F.getPrototypicalRowHeight();var H=this.getFirstRow();var M=function(){return 1};var E=K.get();var L=E.length;netflix.queue.dnd.startingOffset=H.offset();var G=function(){return{left:netflix.queue.dnd.startingOffset.left,top:(netflix.queue.dnd.startingOffset.top+(C*this.qposition))}};var I=D;for(var J=0;J<L;J++){var B=E[J];B.qposition=I;B.outerWidth=M;B.outerHeight=M;B.offset=G;I++}},getPrototypicalRowHeight:function(){var C=netflix.queue.dnd.nonstandardrows||null;var D=A("#qbody tr").get();var E=D.length;for(var B=0;B<E;B++){if(!C||!C[B+1]){return A(D[B]).height()}}return -1},doJqueryPatches:function(){var D=A.ui.intersect;A.ui.intersect=function(G,L,H){if(!L.offset){return false}if(H==="engulfs"){var K=(G.positionAbs||G.position.absolute).top,J=K+G.helperProportions.height;var I=L.offset.top,F=I+L.proportions.height;return K<I&&J>F}return D(G,L,H)};var B=A.fn.offset;A.fn.offset=function(){var F=this[0];if(F&&A.isFunction(F.offset)){return F.offset()}return B.apply(this,arguments)};var E=A.fn.outerWidth;A.fn.outerWidth=function(){var F=this[0];if(F&&A.isFunction(F.outerWidth)){return F.outerWidth()}return E.apply(this,arguments)};var C=A.fn.outerHeight;A.fn.outerHeight=function(){var F=this[0];if(F&&A.isFunction(F.outerHeight)){return F.outerHeight()}return C.apply(this,arguments)};if(A.ui.ddmanager){A.ui.ddmanager.prepareOffsets=function(H,I){var F=A.ui.ddmanager.droppables[H.options.scope];for(var G=0;G<F.length;G++){F[G].visible=F[G].element.css("display")!=="none";if(!F[G].visible){continue}F[G].offset=F[G].element.offset();F[G].proportions={width:F[G].element[0].offsetWidth,height:F[G].element[0].offsetHeight}}};A.ui.ddmanager.drag=function(F,H){var I=null;A.each(A.ui.ddmanager.droppables[F.options.scope],function(){if(this.options.disabled||this.greedyChild||!this.visible){return }var J=A.ui.intersect(F,this,this.options.tolerance);if(J){I=this;return false}});var G=A.ui.ddmanager.currentDropTarget;if(I===G){return }if(G){G._out(H)}if(I){I._over(H);A.ui.ddmanager.currentDropTarget=I}}}},getFirstRow:function(){var B=A("tbody tr:first-child","#queue");if(B===null||B.length===0){B=A("#queue tr:first-child")}return A(B[0])},moveToTop:function(F,B){var D=netflix.queue.dnd;if(D){A("A.mvtopicon",F).attr("href","javascript:void(0)")}var C=A("#queue tr:first-child","#inqueue-header-row");var E=D.getFirstRow();if(B){return D.animateMoveToTop(C,E,F)}E.before(F);D.reorderRows(F,C,true)},animateMoveToTop:function(E,H,G){var D=netflix.queue.dnd;var F=D.dragMetaData.cloneQueueRow(G);var C=G.position();var B=H.position();G.children().css("visibility","hidden");F.css({position:"absolute",top:C.top,left:C.left}).animate({top:"+=4",left:"+=1"},"fast","swing",function(){F.animate({top:B.top},"normal","swing",function(){F.remove();H.before(G);D.reorderRows(G,E,true);G.children().css("visibility","visible")})})},dragMetaData:{addClasses:false,containment:"#queue",axis:"y",distance:4,scroll:true,scrollSensitivity:40,scrollSpeed:24,helper:function(B){return netflix.queue.dnd.dragMetaData.cloneQueueRow(this)},cloneQueueRow:function(C){var B=netflix.queue.dnd;B.helperTable=B.dragMetaData.createDragRowTable();return B.helperTable.html(A(C).clone())},createDragRowTable:function(){var E=A('<table class="qtbl" id="ddrowtable" cellspacing="0" cellpadding="0" style="z-index:1000;"><tbody></tbody></table>');netflix.queue.dnd.helperTable=E;var B=A("#qbox");if(B===null||B.length===0){B=A(document.body)}E.appendTo(B);var D=34;var C=910;E[0].outerWidth=function(){return C};E[0].outerHeight=function(){return D};var F=0;if(A.browser.msie){E.css({cursor:"url("+netflix.Link.imageUrl("cursors/grab.cur")+"), move"});F+=(!A.support.boxModel)?-1:1}else{F++}E.css("margin-left",F);netflix.queue.dnd.helperTable=E;return E},start:function(B,C){netflix.queue.dnd.dragging=true;A(this).children().css("visibility","hidden");netflix.queue.dnd.dragMetaData.toggleCursor(true);if(UserAgent.matches.safari){A("#queue-page-content").addClass("drag-in-progress")}},stop:function(B,C){netflix.queue.dnd.dragging=false;A("div#lGuide,div#rGuide").hide("fast");A(this).children().css("visibility","visible");netflix.queue.dnd.dragMetaData.toggleCursor(false);if(UserAgent.matches.safari){A("#queue-page-content").removeClass("drag-in-progress")}},toggleCursor:function(B){if(!A.browser.msie){A("#queue")[B?"addClass":"removeClass"]("ddgb")}}},dropMetaData:{addClasses:false,accept:"#queue tr",tolerance:"engulfs",prevRow:null,over:function(F,G){var D=netflix.queue.getRow(this);D.addClass("dropBelowMe");netflix.queue.dnd.dropMetaData.updateGuides(D);if(!netflix.queue.isLame){netflix.queue.dnd.dropMetaData.update(D)}var B=parseInt(A("td.pr input:hidden",G.draggable).val(),10),E=this.qposition+1;var C=E<=B;if(!C){E--}A("td.pr input:text",G.helper).val(E)},out:function(B,C){netflix.queue.getRow(this).removeClass("dropBelowMe")},drop:function(C,E){var D=netflix.queue.dnd.dropMetaData;if(D.prevRow){D.prevRow.removeClass("droptarget");D.prevRow=null}var B=netflix.queue.getRow(this);B.removeClass("dropBelowMe");A("div#lGuide,div#rGuide").hide("fast");if(B.is(".header")){netflix.queue.dnd.getFirstRow().before(E.draggable)}else{if(B[0]!=E.draggable[0]){B.after(E.draggable)}}netflix.queue.dnd.reorderRows(E.draggable,B,false)},update:function(C){var B=netflix.queue.dnd.dropMetaData;if(B.prevRow){B.prevRow.removeClass("droptarget")}C.addClass("droptarget");B.prevRow=C},updateGuides:function(G){var F=G.position();var C=A.browser.safari?5:A.support.boxModel?6:7;var H=F.top+G.height()-C;var D=this.lguide;var E=this.rguide;var B=A.support.boxModel?1:0;var I=A.browser.safari?2:1;D.ui.css({top:H,left:F.left-D.width+B}).show();E.ui.css({top:H,left:F.left+G.width()+I}).show()},prevTR:null,lguide:netflix.fang({id:"lGuide",visibleborder:"left",width:{t:5,b:5,l:10,r:0},color:"#111144"}),rguide:netflix.fang({id:"rGuide",visibleborder:"right",width:{t:5,b:5,l:0,r:10},color:"#111144"})},reorderRows:function(B,D,G){var K=A(".pr input",B);var F=null;if(D!==null&&D.length>0){F=A(".pr input",D)}var L=K.filter(":hidden");var H=L.attr("name").substring(2);var C=parseInt(L.val(),10);var I=F?(parseInt(F.filter(":hidden").val(),10)+1):1;if(isNaN(I)){I=1}var J=I<=C;if(!J){I--}if(C===I){return }netflix.queue.dnd.reorder(H,C,I,G);A("#firstqitem").removeAttr("id");if(typeof netflix.queue.dnd.d1HiliteCount!=="undefined"&&netflix.queue.dnd.d1HiliteCount>0){A("#queue tr").removeClass("d1_qi")}(function E(){K.val(I);var R=A(".dtc em",B)[0];R.qposition=I;var P=J?I+1:C;var O=J?C:I-1;var N=0;var Q=J?1:-1;var M=A("#queue").find("tbody tr");M.each(function(){var V=A(this);if(!V.attr("data-deleted")){N++}if(N<P||N>O){return }var T=V.find(".pr input");var U=parseInt(T.val(),10)+Q;T.val(U);var S=V.find(" .dtc em")[0];S.qposition=U})})();netflix.queue.dnd.getFirstRow().attr("id","firstqitem");if(typeof netflix.queue.dnd.d1HiliteCount!=="undefined"&&netflix.queue.dnd.d1HiliteCount>0){A("#queue tr:lt("+netflix.queue.dnd.d1HiliteCount+")","#MainQueueForm").addClass("d1_qi")}},reorder:function(B,C,E,D){A.get("/QueueReorder",{movieid:B,from:C,pos:E,sz:0,mt:D,qtype:netflix.queue.dnd.qType,authURL:netflix.Link.getXsrfToken()},netflix.queue.dnd.reorderCB,"json")},reorderCB:function(B){if(B===null||B.result!=="success"){window.location.reload(true)}},paging:{init:function(B,C){}}}})(jQuery);
